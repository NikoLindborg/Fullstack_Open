(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{38:function(e,n,t){},39:function(e,n,t){"use strict";t.r(n);var c=t(14),r=t.n(c),o=t(3),a=t(1),u=t(0),i=function(e){return Object(u.jsxs)("div",{children:[Object(u.jsxs)("p",{children:[e.contact.name," ",e.contact.number]}),Object(u.jsx)("button",{onClick:function(){return e.remove(e.contact)},children:"delete"})]})},l=function(e){return Object(u.jsxs)("form",{onSubmit:e.addPerson,children:[Object(u.jsxs)("div",{children:["name: ",Object(u.jsx)("input",{value:e.newName,onChange:e.handleNameChange})]}),Object(u.jsxs)("div",{children:["number: ",Object(u.jsx)("input",{value:e.newNumber,onChange:e.handleNumberChange})]}),Object(u.jsx)("div",{children:Object(u.jsx)("button",{type:"submit",children:"add"})})]})},s=function(e){return Object(u.jsx)("form",{onSubmit:e.addFilter,children:Object(u.jsxs)("div",{children:["filter shown with ",Object(u.jsx)("input",{value:e.filter,onChange:e.handleFilterChange}),Object(u.jsx)("button",{type:"submit",children:"add filter"})]})})},d=t(4),j=t.n(d),f="/api/persons",b=function(){return j.a.get(f).then((function(e){return e.data}))},h=function(e){return j.a.post(f,e).then((function(e){return e.data}))},m=function(e,n){return j.a.put("".concat(f,"/").concat(e),n).then((function(e){return e.data}))},O=function(e){return j.a.delete("".concat(f,"/").concat(e)).then((function(e){return e.data}))},p=function(e){var n=e.message,t=e.error;return null===n?null:t?Object(u.jsx)("div",{className:"error",children:n}):Object(u.jsx)("div",{className:"success",children:n})},v=function(){var e=Object(a.useState)([]),n=Object(o.a)(e,2),t=n[0],c=n[1],r=Object(a.useState)(""),d=Object(o.a)(r,2),j=d[0],f=d[1],v=Object(a.useState)(""),x=Object(o.a)(v,2),g=x[0],w=x[1],C=Object(a.useState)(!0),N=Object(o.a)(C,2),S=N[0],k=N[1],y=Object(a.useState)(""),T=Object(o.a)(y,2),D=T[0],F=T[1],L=Object(a.useState)([{}]),P=Object(o.a)(L,2),A=P[0],E=P[1],I=Object(a.useState)(null),J=Object(o.a)(I,2),B=J[0],R=J[1],U=Object(a.useState)(!1),q=Object(o.a)(U,2),z=q[0],G=q[1];Object(a.useEffect)((function(){b().then((function(e){c(e)}))}),[]);var H=function(e){console.log(e),window.confirm("Delete ".concat(e.name,"?"))&&O(e.id).then((function(){R("Deleted ".concat(e.name)),G(!1),setTimeout((function(){R(null)}),5e3),c(t.filter((function(n){return n.id!==e.id})))})).catch((function(n){R("Couldn't delete ".concat(e.name,", perhaps he was already gone?")),G(!0),setTimeout((function(){R(null)}),5e3)}))},K=S?t:A;return Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:"Phonebook"}),Object(u.jsx)(p,{message:B,error:z}),Object(u.jsx)(s,{addFilter:function(e){e.preventDefault(),S&&(console.log("changed"),k(!S));var n=t.map((function(e){return e.name})).map((function(e){return e.toLowerCase()})),c=D.toLowerCase(),r=n.filter((function(e){return e.includes(c)}));E(A.splice(0,A.length)),E(A.concat(t.filter((function(e){return r.includes(e.name.toLowerCase())}))))},filter:D,handleFilterChange:function(e){F(e.target.value)}}),Object(u.jsx)("button",{onClick:function(){return k(!0)},children:"Remove filter"}),Object(u.jsx)("h3",{children:"Add a new"}),Object(u.jsx)(l,{addPerson:function(e){e.preventDefault();var n={name:j,number:g};if(t.map((function(e){return e.name})).includes(n.name)){if(window.confirm("".concat(j," is already added to the phonebook, replace the old number with the new one?"))){var r=t.filter((function(e){return e.name===j}));console.log(r),m(r[0].id,n).then((function(e){c(t.map((function(n){return n.id!==r[0].id?n:e}))),R("Updated phonenumber for ".concat(j)),G(!1),setTimeout((function(){R(null)}),5e3)})).catch((function(e){R("Information of ".concat(j," has already been removed from sever")),G(!0),setTimeout((function(){R(null)}),5e3)}))}return null}h(n).then((function(e){c(t.concat(e)),R("Added ".concat(j)),G(!1),setTimeout((function(){R(null)}),5e3),f("")})).catch((function(e){console.log(e.response.data),R("".concat(e.response.data.error)),G(!0)}))},newName:j,handleNameChange:function(e){f(e.target.value)},newNumber:g,handleNumberChange:function(e){w(e.target.value)}}),Object(u.jsx)("h2",{children:"Numbers"}),Object(u.jsx)("div",{children:K.map((function(e){return Object(u.jsx)(i,{contact:e,remove:H},e.name)}))})]})};t(38);r.a.render(Object(u.jsx)(v,{}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.be443e42.chunk.js.map